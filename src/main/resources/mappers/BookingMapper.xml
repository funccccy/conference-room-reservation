<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace等于mapper接口类的全限定名  -->
<mapper namespace="com.conference.mapper.BookingMapper">

    <insert id="insert" parameterType="com.conference.entity.Booking">
        INSERT INTO booking (
        room_id,
        customer_id,
        start_time,
        end_time,
        total_hours,
        total_price,
        status_name,
        payment_status,
        create_time,
        booking_date  <!-- 添加缺失的字段 -->
        ) VALUES (
        #{roomId},
        #{customerId},
        #{startTime},
        #{endTime},
        #{totalHours},
        #{totalPrice},
        #{statusName},
        #{paymentStatus},
        #{createTime},
        #{bookingDate}  <!-- 传入参数 -->
        )
    </insert>

    <select id="selectByCustomerId" resultType="com.conference.entity.Booking">
        SELECT * FROM booking
        WHERE customer_id = #{customerId}
        ORDER BY booking_date DESC
    </select>

    <select id="selectById" resultType="com.conference.entity.Booking">
        SELECT * FROM booking
        WHERE booking_id = #{bookingId}
    </select>

    <update id="updateBooking" parameterType="com.conference.entity.Booking">
        UPDATE booking
        <set>
            <if test="statusName != null">status_name = #{statusName},</if>
            <if test="paymentStatus != null">payment_status = #{paymentStatus},</if>
            <if test="totalPrice != null">total_price = #{totalPrice},</if>
            <if test="startTime != null">start_time = #{startTime},</if>
            <if test="endTime != null">end_time = #{endTime}</if>
        </set>
        WHERE booking_id = #{bookingId}
    </update>

</mapper>